# Some tips for dev

[TOC]

[Flask Tutorial](https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world)

[Gyazo](https://gyazo.com/captures) : online image editor and sharing

https://libp2p.io/

https://graphql.org/

https://github.com/webrtc

https://nifi.apache.org/

xcode hotkeys ([fold](https://stackoverflow.com/questions/2364484/enable-code-folding-by-default), [short cuts](http://roadfiresoftware.com/2015/05/useful-xcode-keyboard-shortcuts-for-developers/))

[programming-blockchains-step-by-step](https://github.com/openblockchains/programming-blockchains-step-by-step)

[Tui.Calendar](https://github.com/duangenquan/tui.calendar) 

[Simple, powerful online communities.](https://github.com/duangenquan/spectrum)

[十年开发经验之谈](https://cloud.tencent.com/developer/article/1004735)

[各类笔记 wdx](https://github.com/wdxtub/WDXpeak)

# Document Sharing

[写文档，就用语雀](https://yuque.com/?utm_source=ruanyifeng.com) from alibaba

Google docs

# Hash

TLSH - Trend Micro Locality Sensitive Hash ([c++ & python](https://github.com/trendmicro/tlsh),[js version](https://github.com/idealista/tlsh-js))

# Distributed Systems

[A Thorough Introduction to Distributed Systems](https://hackernoon.com/a-thorough-introduction-to-distributed-systems-3b91562c9b3c)



# Database

[Druid](http://druid.io/) is a high-performance, column-oriented, distributed data store.

[Paxos](https://www.paxos.com/) combines regulated Trust status with distributed ledger technology to create a modern settlement platform.

[Raft](https://raft.github.io/) is a consensus algorithm that is designed to be easy to understand. It's equivalent to Paxos in fault-tolerance and performance. 

SQL

+ MySQL

NoSQL

+ Redis
+ cassandra
+ MongoDB

# UI Designs

[dribbble](https://dribbble.com/shots)

[React components that implement Google's Material Design](https://github.com/mui-org/material-ui)

# Bigdata visualization 

## Airbnb

[SuperSet](https://medium.com/@InDataLabs/superset-benefits-and-limitations-of-the-open-source-data-visualization-tool-by-airbnb-8dc8ac81efa9) is the open source data visualization tool by Airbnb. [Incubator-superset Github](https://github.com/apache/incubator-superset) with [its docker image](https://github.com/amancevice/superset).

## Uber

https://eng.uber.com/deckgl-v5/ visualize map data

## Others

[Pivot (imply)](https://docs.imply.io/on-premise/quickstart)

[Metabase](https://github.com/metabase/metabase), the simplest, fastest way to get business intelligence and analytics to everyone in your company.



# Hardware

[Intel vpro](https://en.wikipedia.org/wiki/Intel_vPro)

[vivostick](https://www.asus.com/us/Stick-PCs/VivoStick-PC-TS10/)

# Deployment

[Concourse](https://concourse-ci.org/) is an open-source continuous thing-doer.

[Scripts to configure various monitoring services on Ubuntu 14.04](https://github.com/duangenquan/monitoring)

[Monitor Everything](https://ianunruh.com/2014/05/monitor-everything-part-4.html)

rancher

kubernetes

kafaka  

graphite

graphana

sonarwhal ([Github](https://github.com/sonarwhal), [site](https://sonarwhal.com/)) is a linting tool that will help you with your site's accessibility, speed, security and more, by checking your code for best practices and common errors.



**![img](https://lh6.googleusercontent.com/0SPBzY2thQyMUx8y5LJZU0siKVA9J7EuVYfyv9ethdzDwTvnp8EIwtpUtMtXvg85QwUmEsTQ5qu-8e0sX9mSw5wJI_iW_ZaJKiMzJAS2kUY_wozgzDcyWNacRt8QIAx9_fB1uNid)**

## [Uber distributed architecture](https://blog.pragmaticengineer.com/distributed-architecture-concepts-i-have-learned-while-building-payments-systems/)



## [Netflix High Available Server Deployment](https://medium.com/@NetflixTechBlog/tips-for-high-availability-be0472f2599c)

Netflix built and use [Spinnaker](http://spinnaker.io/) as a platform for continuous integration and delivery. Many of the best practices discussed here have been encoded into Spinnaker.d

## Performance Monitoring

[flamebearer](https://github.com/mapbox/flamebearer)

#### **Website Monitoring Tools**

- [Insping](https://www.insping.com/)
- [Updown](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=0ahUKEwic9s39tqDXAhXINo8KHYKsAPQQFggsMAE&url=https%3A%2F%2Fupdown.io%2F&usg=AOvVaw1rGtd0XEQqX40wWxiLpXVb)
- [Pingometer](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwiapI3wtqDXAhXDLo8KHYZpCFUQFggnMAA&url=https%3A%2F%2Fpingometer.com%2F&usg=AOvVaw3hrdapeSICYDM8nqttqN_j)
- [Uptime Robot](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwjv45zotqDXAhXLpI8KHY--CbEQFgguMAA&url=https%3A%2F%2Fuptimerobot.com%2F&usg=AOvVaw1hD4IExGsCbMZNpjEF7mn_)
- [Pingdom](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwigqLLitqDXAhWMsY8KHcbbDP0QFggnMAA&url=https%3A%2F%2Ftools.pingdom.com%2F&usg=AOvVaw3pGkR9wdb5aLnnAzIQ0lVS)

#### Server Monitoring Tools

- **[sensu](https://github.com/sensu/sensu)**
- **[Ganglia](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=0ahUKEwiLg5fAtqDXAhXGKo8KHZOHBvwQFgg8MAE&url=http%3A%2F%2Fganglia.sourceforge.net%2F&usg=AOvVaw0MGWK9N3jFEYMUE3X9kpe6)**
- [Insping](https://www.insping.com/)
- Monitis :  [Monitor.us](https://www.monitis.com/free-monitoring-sign-up) 
- [Nagios Core](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwi_vdzKtqDXAhWDro8KHasuAMkQFggnMAA&url=https%3A%2F%2Fwww.nagios.com%2Fsolutions%2Fbandwidth-monitoring%2F&usg=AOvVaw2WmMZ4PrFL4e7mB7ybCyre)
- [Collectd](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwjxhIu5tqDXAhWJOI8KHYscD3MQFggnMAA&url=https%3A%2F%2Fcollectd.org%2F&usg=AOvVaw3gHlofJ33Nrrt7Rsj5wTO5)
- [new relic](https://github.com/newrelic/node-newrelic) instruments your application for performance monitoring.

#### **Network Monitoring Tools**

- [Nagios](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwi-19CytqDXAhVMvI8KHV6NAlAQFggnMAA&url=https%3A%2F%2Fwww.nagios.org%2F&usg=AOvVaw3LQedeXaGoWMuftijMZUQL)
- [Capsa Free](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwjuu_2rtqDXAhUHwI8KHZOzAZ0QFggnMAA&url=http%3A%2F%2Fwww.colasoft.com%2Fcapsa-free%2F&usg=AOvVaw0W7bp0UlF6JVBf_0O-_Hs6)
- [Fiddler](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwiNx6OltqDXAhVIto8KHZZdAZwQFggnMAA&url=https%3A%2F%2Fwww.telerik.com%2Ffiddler&usg=AOvVaw1YbjZAC6d-In6jOf4TEw5b)
- [NetworkMiner](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwiHj7qetqDXAhWJtI8KHcZeCb8QFggnMAA&url=http%3A%2F%2Fwww.netresec.com%2F%3Fpage%3DNetworkMiner&usg=AOvVaw3lsVvlUWmMKXvt9SI6nCxp)
- [Pandora FMS](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwinsLOVtqDXAhUJqI8KHf_UBcEQFggnMAA&url=https%3A%2F%2Fpandorafms.com%2F&usg=AOvVaw2XEsv0NR4jG2mGoGhAUoH8)

#### Application Performance Monitoring Tools

- [Insping](https://www.insping.com/)
- [New Relic APM](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwjV07iCtqDXAhVHwI8KHRu5BAoQFggrMAA&url=https%3A%2F%2Fnewrelic.com%2Fapplication-monitoring&usg=AOvVaw0hw5xmkfio_M7KoanQ5EfY)
- [AppDynamics](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwj_7e_6taDXAhXLqY8KHflpCrYQFggnMAA&url=https%3A%2F%2Fwww.appdynamics.com%2F&usg=AOvVaw2OZsMW3zncuAbLamMK8HfX)
- Foglight
- [ExtraHop](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwjg_afotaDXAhXFO48KHQ2kA0YQFggnMAA&url=https%3A%2F%2Fwww.extrahop.com%2F&usg=AOvVaw1WADEHMdyDpPDUp2sjSi5g)

#### **Real User Monitoring Tools**

- [AppDynamics](https://en.wikipedia.org/wiki/AppDynamics)
- [Dynatrace](https://en.wikipedia.org/wiki/Dynatrace)
- [inspectIT](https://en.wikipedia.org/wiki/InspectIT)
- [Akamai](https://en.wikipedia.org/wiki/Akamai)
- [Pingdom](https://tools.pingdom.com/)

### Licenses

[GPL for dummies](http://blog.milkingthegnu.org/2008/04/gnu-gpl-for-dum.html)

[Compare GPL, LGPL, BSD](https://fosswire.com/post/2007/04/the-differences-between-the-gpl-lgpl-and-the-bsd/)

[General comparison for open source licenses](https://en.wikipedia.org/wiki/Comparison_of_free_and_open-source_software_licenses)

#Markdown Tips

[Markdown References](https://support.typora.io/Markdown-Reference/)
Tools:

+ Typora
+ CMD Markdown
+ StackEdit
+ XPONENTIAL

# Systems

## Linux

```bash
# Show Json
pip install pjson
pip install underscore
cat data.json | pjson
cat data.json | underscore print

# Copy sumbolic links
cp -p src dst

# Add dynamic folders
add myapp.conf to /etc/ld.so.conf.d/
ldconfig
```



## CentOS

```bash
# Clean cache
# https://www.getpagespeed.com/server-setup/clear-disk-space-centos
yum -y install yum-utils

# Show login info
last
last | tac

# show folders with sizes
du -sh *

# Delete a user
sudo su -
userdel -r username

```



## MAC

[reset iphone](https://www.safewiper.com/tutorials/reset-iphone-without-apple-id.htmlsignout)

[icloud](https://support.apple.com/en-us/HT208242)

[update error](https://support.apple.com/en-us/ht201412)

[Wipe macOS](https://www.macworld.co.uk/how-to/mac/how-reset-mac-factory-settings-3494564/)

[Wipe PC Windows](http://home.bt.com/tech-gadgets/computing/windows-10/how-to-wipe-your-pc-with-windows-10-11364002707321)

Reinstall Ubuntu

- [create boot stick](https://tutorials.ubuntu.com/tutorial/tutorial-create-a-usb-stick-on-macos#0), [create boot stick using etcher](https://askubuntu.com/questions/801458/how-to-create-a-bootable-usb-stick-on-a-apple-macbook)
- download [ubuntu releases](http://releases.ubuntu.com/)



## Gmail Immigration

References ([link1](https://www.labnol.org/internet/copy-gmail-messages/28085/))

# Video Conference

+ uber conference
+ zoom.us
+ google hangout
+ skype

# Upload Files to Server

## AWS

### Upload files to S3 using CURL

```bash
file=$1
region=YOURREGION
bucket=YOURBUCKET
resource="/${bucket}/${file}"
contentType="application/x-www-form-urlencoded"
dateValue=`date -R`
stringToSign="PUT\n\n${contentType}\n${dateValue}\n${resource}"
s3Key=YOURKEY
s3Secret=YOURSECRET
echo "SENDING TO S3"
signature=`echo -en ${stringToSign} | openssl sha1 -hmac ${s3Secret} -binary | base64`
curl -vv -X PUT -T "${file}" \
  -H "Host: s3.${region}.amazonaws.com" \
  -H "Date: ${dateValue}" \
  -H "Content-Type: ${contentType}" \
  -H "Authorization: AWS ${s3Key}:${signature}" \
  https://s3.${region}.amazonaws.com/${bucket}/${file}
```



# Stream

[cisco h264](https://github.com/cisco/openh264)



## H264 Live Player ([Github](https://github.com/131/h264-live-player))



## UV4L ([projects](http://www.linux-projects.org/))



## Webrtc ([GitHub](https://github.com/webrtc/samples))



## GStreamer ([wiki](https://en.wikipedia.org/wiki/GStreamer))

[GStreamer-1.8.1 rtsp server and client on ubuntu](https://telecom.altanai.com/2016/05/20/gstreamer-1-8-1-rtsp-server-and-client-on-ubuntu/)

[GStreamer Examples for UDP/TCP/RTP/RTSP/ABS](http://trac.gateworks.com/wiki/Yocto/gstreamer/streaming)

```bash
sudo apt-get install bison
sudo apt-get install flex

rtspsrc location=yoururl ! rtph264depay ! h264parse ! rtph264pay name=pay0 pt=96

gst-launch-1.0 rtspsrc location=yoururl latency=2000 name=demux demux. ! decodebin ! queue2 ! autovideosink sync=true demux. ! decodebin ! queue2 ! autoaudiosink sync=true
```

## [FFmpeg+crtmpserver](https://telecom.altanai.com/category/media-processes/live-streaming-and-broadcasting/)

```bash
ffmpeg -i yoururl -an -r 10 -c:v libx264 -q 1 -f rtsp -metadata title=test rtsp://10.1.1.178:5554/flvplayback

ffmpeg -i yoururl -f flv -s qvga -b 750000 -ar 11025 -metadata streamName=aaa "tcp://10.1.1.178:6666/live"
```

## FFMPEG + HLS

```bash
ffmpeg -y -i yoururl -codec copy -bsf h264_mp4toannexb -map 0 -f segment -segment_time 10 -segment_format mpegts -segment_list "./VDO/prog_index.m3u8" -segment_list_type m3u8 "./VDO/fileSequence%d.ts"
```

C++ Codes for ffmpeg with HLS

```c++
av_dict_set(&opt, "segment_format", "mpegts", 0);
av_dict_set(&opt, "segment_list_type", "m3u8", 0);
av_dict_set_int(&opt, "segment_list_size", 0, 0);
av_dict_set(&opt, "segment_time_delta", "0.1", 0);
av_dict_set(&opt, "segment_time", "50.0", 0);
av_dict_set(&opt, "segment_list_flags", "cache+live", 0);
```



# Cloud v.s. Edge

Intel AI DevCloud

# MAC

[Snapshot](https://www.cnet.com/how-to/three-ways-to-take-a-screenshot-on-a-mac/)

- command+shift+3 : whole screen to png
- command+shift+4 : select a region
- command+shift+4   space : select a window to png

Note that, if press these hot keys with control, the screenshot is in memory (not in file).

[Photo Editor](https://www.techradar.com/news/the-best-free-mac-photo-editor)

# Python

## Auto format

```bash
# https://github.com/ambv/black
pip install black
black {source_file_or_directory}
```



## Generate installation dependencies

```bash

## Method 1
pip freeze > requirements.txt
## Method 2
pip install pipreqs
pipreqs /path/to/project
```

## Data structures

[data structure list](https://dev.to/georgeoffley/data-structures-in-python-lists-and-the-avengers-305f)

## Search solution for errors from stack overflow

[Rebound](https://github.com/shobrook/rebound ) is a command-line tool that instantly fetches Stack Overflow results when you get a compiler error. Just use the `rebound` command to execute your file.



# JS

### Object.assign()

The Object.assign() method is used to copy the values of all enumerable own properties from one or more source objects to a target object. It will return the target object.

```js
const object1 = {
  a: 1,
  b: 2,
  c: 3
};

const object2 = Object.assign({c: 4, d: 5}, object1);

console.log(object2.c, object2.d);
// expected output: 3 5
```

### [OW checks function arguments](https://github.com/sindresorhus/ow)

JavaScript supports long long ints

```bash
const a = 2172141653n;
const b = 15346349309n;
a * b // 33334444555566667777n
Number(a) * Number(b) // 33334444555566670000
```

## this

this in js shows the running environment.

```bash
var obj = {
  foo: function () { console.log(this.bar) },
  bar: 1
};

var foo = obj.foo;
var bar = 2;

obj.foo() // 1
foo() // 2
```



##Others

[Mustard UI](https://mustard-ui.com/) is a starter CSS framework that actually looks good.

[Rebound](https://github.com/shobrook/rebound ) is a command-line tool that instantly fetches Stack Overflow results when you get a compiler error. Just use the `rebound` command to execute your file. 

# R

## [Installation in windows and mac](https://www.andrewheiss.com/blog/2012/04/17/install-r-rstudio-r-commander-windows-osx/)

Highlight installations for Mac OS X

- Download and install [R](http://cran.us.r-project.org/) (R is a powerful open source program for statistics and graphics)
- Download and install [Rstudio](http://rstudio.org/download/desktop) (IDE for R)
- Download and install [TCL/TK](http://cran.r-project.org/bin/macosx/tools/): OS X needs this to run R Commander (A GUI for R)
- Download and install [XQuartz](http://xquartz.macosforge.org/)
- Open Rstudio and open packages ![](./images/R-install-package.png)
- Install packages ![](./images/R-install-package-2.png)
- 

## Tutorials

[DataScienceR](https://github.com/ujjwalkarn/DataScienceR)

[Learner](https://github.com/rstudio/learnr)

[Examples](https://gist.github.com/asimihsan/6937989)

```bash
# Create directory if not exists
mainDir = file.path(getwd(),"Documents")
subDir = "reports"
dir.create(file.path(mainDir, subDir), showWarnings = FALSE)
saveDir = file.path(mainDir, subDir)

# Run in cmd
/Library/Frameworks/R.framework/Resources/bin/Rscript example.R


```



# AWS

```bash
# Fix remote problems
chmod 400 xx.pem
```



# Docker

Docker Cheat Sheet( [Github](https://github.com/wsargent/docker-cheat-sheet), [pdf](https://www.docker.com/sites/default/files/Docker_CheatSheet_08.09.2016_0.pdf), [入门教程](http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html))

```bash
# Log into a registry
# Create repo in https://hub.docker.com
docker login
docker login [my.registery.com:8000] --username=yourhubusername --email=youremail@company.com


## Images
# Get one image
docker pull [repo]/[image]:[tag]
# Build an image from Dockerfile and tag the image
docker build -t myapp:1.0 .
# List all images
docker images
# Delete an image from local image store
docker rmi [repo]/[image]:[tag]
# Retag a local image
docker tag myapp:1.0 myrepo/myapp:1.0
# Push an image to registry
docker push myrepo/myapp:1.0

## Containers
# List all running containers
docker ps
# List all exited containers
docker ps -aq -f status=exited
# Remove stopped containers
docker ps -aq --no-trunc -f status=exited | xargs docker rm
# Stop one container
docker stop [container name]
# Remove one container
docker rm [container name]

# Run image in a container
docker run -ti --rm -e DISPLAY=$DISPLAY -v /home/ubuntu:/var/ myapp /bin/bash
# Exit from a container
exit
```

Examples

```bash
docker pull minio/minio
docker run -dti -p 9001:9000 --name demoMinio   -e "MINIO_ACCESS_KEY=admin"   -e "MINIO_SECRET_KEY=admin"   -v /home/ubuntu/data:/data   -v /home/ubuntu/.minio:/root/.minio   minio/minio server /data
```

[Docker CE Alpine](https://wiki.alpinelinux.org/wiki/Alpine_Linux_package_management)

```bash
apk update
apk search xxx
apk add xxx
```

References

> + [Remove docker container](https://zaiste.net/removing_docker_containers/)
> + [Openface](https://github.com/cmusatyalab/openface/blob/master/Dockerfile)
> + [Docker tutorial](https://ropenscilabs.github.io/r-docker-tutorial/04-Dockerhub.html)

# Code Editor

atom

sublime

visual studio

# Git

[Git cheat sheet](https://services.github.com/on-demand/downloads/github-git-cheat-sheet.pdf) ([copy](../cheatsheet/gitcheatsheet.pdf))

Common

```bash
# Clone projects
git clone <project url>

# Set credentials
git config --global user.name "John Doe"
git config --global user.email johndoe@example.com

# If username and password pop up often when commit
# we can use this cmd before commits
git config credential.helper store

# Add commits
git commit -a -m "commit"

# Generate keys
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
cat ~/.ssh/irs.pub
```

Branches

```bash
# Show all branches
git branch -a
# Create new branches
git checkout -b newbranch
# Delete a local branch
git branch -d branch
# Delete a remote branch
git branch -r -d origin/branch
# Sync with server to prune branches
git fetch --prune
```



Clone one branch only

```bash
git clone -b mybranch --single-branch git://sub.domain.com/repo.git
```

Submodule

```bash
# Add one submodule
git submodule add https://github.com/socketio/socket.io 
# Update one submodule 
git submodule update --init --recursive
# Clone a project with submodules
git clone --recursive <project url>
```

Delete history

```bash
# $1 is SHA-1 of the commit you want to keep
git checkout --orphan temp $1 
git commit -m "Truncated history" 
git rebase --onto temp $1 master 
git branch -D temp
git gc --prune=all
git repack -a -f -F -d
```



# ffmpeg

## Hardware Acceleration with Intel



References

https://stackoverflow.com/questions/36260474/encoding-of-two-full-hd-streams-in-linux-gpu-with-intel-hd4000-va-api-ffmp

https://wiki.archlinux.org/index.php/Hardware_video_acceleration#Installing_VA-API

https://trac.ffmpeg.org/wiki/Hardware/QuickSync

https://software.intel.com/en-us/articles/accessing-intel-media-server-studio-for-linux-codecs-with-ffmpeg

https://software.intel.com/en-us/blogs/2016/02/28/faster-media-apps-by-using-hw-acceleration

https://software.intel.com/en-us/articles/video-transcoding-on-intel-xeon-scalable-processor-with-ffmpeg

[Intel MovAVI](http://img.movavi.com/online-help/videoconverter/15/nvidia_hardware_acceleration.htm?st=MA%3D%3D&sct=MA%3D%3D&mw=MzAw&ms=AgE%3D)



## Build

[ffmpeg compile guide](https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu)

[ffmpeg build script](https://github.com/markus-perl/ffmpeg-build-script)

[ffmpeg streaming](https://telecom.altanai.com/category/media-processes/live-streaming-and-broadcasting/)

```bash
# Preliminary
sudo apt-get install g++ gcc build-essential liblzma-dev libva-dev libfaac-dev libnuma-dev libsdl2-dev libbz2-dev libssl-dev libvdpau-dev idn libnss3-dev nasm

# Curl
wget https://curl.haxx.se/download/curl-7.47.1.tar.bz2
tar -vxjf curl-7.47.1.tar.bz2
CFLAGS=-fPIC ./configure --with-crypto --with-idn --with-ssl --with-nss
make

# H264
wget ftp://ftp.videolan.org/pub/x264/snapshots/last_x264.tar.bz2
tar --bzip2 -xvf last_x264.tar.bz2
cd x264-snapshot-XXXXXXXX-XXXX/
CFLAGS=-fPIC  ./configure --enable-static --enable-shared
make
sudo make install

# ffmpeg
wget http://ffmpeg.org/releases/ffmpeg-4.0.tar.bz2
tar -zxvf ffmpeg-4.0.tar.bz2
cd ffmpeg-xxx/
CFLAGS=-fPIC ./configure --enable-libx264 --enable-gpl --enable-shared

```



Run compiled ffmpeg

```bash
sudo make install
sudo vim /etc/ld.so.conf
# Add /usr/local/lib at the end of ld.so.conf
./ffmpeg
```



## Tips

```bash
# concate videos
printf "file '%s'\n" ./*.mp4 > list.txt
./ffmpeg -f concat -safe 0 -i list.txt -c copy output.mp4

# Link orders
LFLAGS += -lm -lX11 -lvdpau -lva-drm -lva-x11 -lva

# ffmpeg_g contains debug information for ffmpeg

```



# C++ Profiling in Linux

[cpuload example](https://github.com/gklingler/cpuProfilingDemo/blob/master/cpuload.cpp).

## valgrind

```bash
#!/bin/bash
# install valgrind & kcachegrind
sudo apt-get install valgrind
sudo apt-get install kcachegrind

# build the program (no special flags are needed)
g++ -std=c++11 cpuload.cpp -o cpuload

# run the program with callgrind; generates a file callgrind.out.12345 that can be viewed with kcachegrind
valgrind --tool=callgrind ./cpuload

# open profile.callgrind with kcachegrind
kcachegrind callgrind.out.xxxxx
```

Note that, please enable debug information when compiling by

```bash
CFLAGS+=-ggdb
NOSTRIP=1
```

## gperftools

Step 1. Make binary with debug information

```bash
sudo apt-get install google-perftools
sudo apt-get install tau
sudo ln -s /usr/lib/libprofiler.so.0 /usr/lib/libprofiler.so

CFLAGS += -DWITHGPERFTOOLS
LFLAGS += -lprofiler
```

Step 2. Run a binary as normal

```bash
./cpuload
```

Step 3. Run prof

```bash
google-pprof --callgrind ./cpuload profile.log > profile.callgrind
kcachegrind profile.grind
```



## gprof

Step 1. Add -pg argument to the compiler's command line

```bash
g++ -Wall -g -pg cpuload.cpp -o kruse
```

The binary should not loop infinitely. 

Step 2. Run a binary as normal

```bash
./kruse param1 param2
```

After execution, gmon.out wil be obtained automatically.

Step 3. Run grof binary > output.log

```bash
gprof kruse > output.log
```

 

References

> - [gprof, valgrind, gperftool](http://gernotklingler.com/blog/gprof-valgrind-gperftools-evaluation-tools-application-level-cpu-profiling-linux/)
> - [gprof Quick-Start Guide](https://web.eecs.umich.edu/~sugih/pointers/gprof_quick.html)
> - [gperftools wiki](http://kratos-wiki.cimne.upc.edu/index.php/How_to_Profile_an_application_(using_google-perftools))
> - 

# Others



```bash
# check missing .so dependencies
ldd binary
```



# Author

duangenquan@gmail.com